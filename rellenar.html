<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego de Rellenar Espacios - Seguridad</title>
<style>
body { 
  font-family:'Poppins',sans-serif; 
  background:#f4f7fb; 
  display:flex; 
  justify-content:center; 
  align-items:center; 
  min-height:100vh; 
  margin:0; 
  user-select:none; 
}
.app { 
  width:96vw; 
  max-width:900px; 
  background:#fff; 
  border-radius:16px; 
  padding:24px; 
  box-shadow:0 10px 25px rgba(0,0,0,0.06); 
  transition:opacity 0.5s; 
}
h1 { color:#02297b; text-align:center; }
.text-container { margin:20px 0; font-size:1.1rem; line-height:1.6; }

.blank {
  display: inline-block;        /* para poder poner un width */
  min-width: 50px;              /* ancho mínimo de la línea */
  border-bottom: 2px solid #2563eb; /* la línea azul */
  margin: 0 2px;                /* pequeño espacio a los lados */
  vertical-align: text-bottom;  /* alineado con el texto */
  text-align: center;           /* texto centrado si se llena */
  color: #000;
  font-size: 1rem;
  line-height: 1.2;             /* igual que el texto */
  background: transparent;      /* sin fondo */
  padding: 0;                   /* sin padding extra */
}
.blank.filled {
  background: transparent;
  border-color: #161ba3;
  color: #000;
}

.words-container { display:flex; flex-wrap:wrap; gap:12px; margin-top:20px; }
.word { 
  padding:6px 12px; 
  background:#04205d; 
  color:white; 
  border-radius:12px; 
  cursor:pointer; 
  transition: transform 0.2s; 
  user-select:none; 
}
.word:active { transform: scale(1.05); }
.footer { margin-top:16px; text-align:center; font-size:1rem; color:#64748b; }
@media (max-width:600px) { 
  .blank { min-width:60px; min-height:20px; line-height:20px; font-size:0.9rem; padding:3px 6px; } 
  .word { padding:6px 10px; font-size:0.9rem; }
}
</style>
</head>
<body>
<div class="app fade-in" id="app">
  <h1>Llene los espacios en blanco</h1>
  <div class="text-container" id="textContainer"></div>
  <div class="words-container" id="wordsContainer"></div>
  <div class="footer" id="footer"></div>
</div>

<script>
const rounds = [
  { text: "Nunca compartas tu ___1___ con extraños, ni siquiera en redes ___2___.", blanks: ["contraseña", "sociales"] },
  { text: "Protege tus datos mediante ___1___ fuertes y no uses la misma ___2___ en varios servicios.", blanks: ["claves", "contraseña"] },
  { text: "Activa la ___1___ en tus cuentas y evita hacer clic en enlaces ___2___ que recibas por correo.", blanks: ["autenticación", "sospechosos"] },
  { text: "No compartas tu ___1___ y revisa siempre los ___2___ de ___3___ de tus cuentas.", blanks: ["usuario", "ajustes", "privacidad"] }
];

let roundIndex = 0;
let isTransitioning = false;

function startRound() {
  const container = document.getElementById("textContainer");
  const wordsContainer = document.getElementById("wordsContainer");
  container.innerHTML = "";
  wordsContainer.innerHTML = "";

  const round = rounds[roundIndex];
  document.getElementById("footer").textContent = `Ronda ${roundIndex + 1} de ${rounds.length}`;

  // Generar blanks
  const parts = round.text.split(/___\d+___/);
  const blanks = [];
  for (let i = 0; i < parts.length; i++) {
    container.append(parts[i]);
    if (i < round.blanks.length) {
      const span = document.createElement("span");
      span.className = "blank";
      span.dataset.answer = round.blanks[i];
      container.appendChild(span);
      blanks.push(span);
    }
  }

  // Mezclar palabras
  const shuffled = shuffle([...round.blanks]);
  shuffled.forEach(word => {
    const div = document.createElement("div");
    div.className = "word";
    div.textContent = word;
    div.addEventListener("click", () => {
      const emptyBlank = blanks.find(b => !b.classList.contains("filled"));
      if (emptyBlank) {
        const correctAnswer = emptyBlank.dataset.answer.toLowerCase();
        if (word.toLowerCase() === correctAnswer) {
          moveWordToBlank(div, emptyBlank);
        } else {
          emptyBlank.style.background = "#fee2e2";
          setTimeout(() => { emptyBlank.style.background = "#eef2ff"; }, 300);
        }
      }
    });
    wordsContainer.appendChild(div);
  });
}

function moveWordToBlank(wordEl, blankEl) {
  const wordRect = wordEl.getBoundingClientRect();
  const blankRect = blankEl.getBoundingClientRect();
  const clone = wordEl.cloneNode(true);
  clone.style.position = "absolute";
  clone.style.left = wordRect.left + "px";
  clone.style.top = wordRect.top + "px";
  clone.style.margin = "0";
  clone.style.zIndex = 1000;
  clone.style.transition = "all 0.5s ease";
  document.body.appendChild(clone);

  clone.getBoundingClientRect();
  const deltaX = blankRect.left + blankRect.width / 2 - (wordRect.left + wordRect.width / 2);
  const deltaY = blankRect.top + blankRect.height / 2 - (wordRect.top + wordRect.height / 2);

  clone.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(0.8)`;
  clone.style.opacity = 0.7;

  clone.addEventListener("transitionend", () => {
    blankEl.textContent = wordEl.textContent;
    blankEl.classList.add("filled");
    clone.remove();
    wordEl.remove();
    checkRoundComplete();
  }, { once: true });
}

function checkRoundComplete() {
  if (isTransitioning) return;
  const blanks = document.querySelectorAll(".blank");
  if (Array.from(blanks).every(b => b.classList.contains("filled"))) {
    isTransitioning = true;
    const app = document.getElementById("app");
    app.classList.remove("fade-in");
    app.classList.add("fade-out");
    setTimeout(() => {
      roundIndex++;
      if (roundIndex < rounds.length) {
        startRound();
        app.classList.remove("fade-out");
        app.classList.add("fade-in");
      } else {
        document.getElementById("textContainer").textContent = "¡Juego completado!";
        document.getElementById("wordsContainer").innerHTML = "";
        document.getElementById("footer").textContent = "";
      }
      isTransitioning = false;
    }, 500);
  }
}

function shuffle(a) {
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

startRound();
</script>
</body>
</html>
